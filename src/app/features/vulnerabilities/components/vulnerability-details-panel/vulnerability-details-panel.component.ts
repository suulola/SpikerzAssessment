import { ChangeDetectionStrategy, Component } from '@angular/core';
import { CommonModule } from '@angular/common';
import { RemediationCardComponent } from '../remediation-card/remediation-card.component';
import { type RemediationTechniqueData } from '@core/models';

@Component({
  selector: 'app-vulnerability-details-panel',
  standalone: true,
  imports: [CommonModule, RemediationCardComponent],
  templateUrl: './vulnerability-details-panel.component.html',
  styleUrl: './vulnerability-details-panel.component.scss',
  changeDetection: ChangeDetectionStrategy.OnPush
})
export class VulnerabilityDetailsPanelComponent {
  readonly remediationTechniques: readonly RemediationTechniqueData[] = [
    {
      id: 'tech-a',
      title: 'Emergency patch',
      shortDescription: 'Upgrade OpenSSH to a fixed release (9.8p1 or vendor backport).',
      fullDescription: 'Deploy the vendor-fixed OpenSSH build across all exposed hosts. Validate package signatures, restart sshd during the maintenance window, and confirm the running version with configuration drift checks.',
      type: 'A'
    },
    {
      id: 'tech-b',
      title: 'Compensating controls',
      shortDescription: 'Restrict SSH access to approved IP ranges and jump hosts.',
      fullDescription: 'Apply temporary allowlists at the edge firewall and cloud security groups. Enforce MFA on the bastion, and disable password auth to reduce exposure while patching completes.',
      type: 'B'
    },
    {
      id: 'tech-c',
      title: 'Monitoring and detection',
      shortDescription: 'Add runtime detections for sshd anomalies and exploit attempts.',
      fullDescription: 'Enable detailed SSH logs, alert on repeated pre-auth crashes, and monitor for abnormal session creation. Forward events to the SIEM and set high-severity alerts for SSH port scanning spikes.',
      type: 'C'
    }
  ] as const;
}
